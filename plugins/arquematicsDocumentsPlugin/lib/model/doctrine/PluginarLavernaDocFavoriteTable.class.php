<?php

/**
 * PluginarLavernaDocFavoriteTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class PluginarLavernaDocFavoriteTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object PluginarLavernaDocFavoriteTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('PluginarLavernaDocFavorite');
    }
    
    /**
     * 
     * @param int $profileId
     * @param int $docId
     * @return query
     */
    public function getQueryDocProfile( $docId, $profileId, $conn = false)
    {
        $query = Doctrine_Core::getTable('arLavernaDocFavorite')
            ->createQuery('u')
            ->where('u.laverna_id = ? AND u.user_id = ?', array($docId, $profileId));

        if ($conn)
        {
           $query->setConnection($conn);  
        }
        
        return $query;
    }
    
    /**
     * 
     * @param int $profileId
     * @param int $docId
     * @return arLavernaDocTrash
     */
    public function getByDocProfile($docId, $profileId,$conn = false )
    {
        $query = Doctrine_Core::getTable('arLavernaDocFavorite')
                  ->getQueryDocProfile($docId, $profileId,$conn);

        return $query->fetchOne();
    }
    /**
     * true si el documento es favorito
     * 
     * @param type $docId
     * @param type $profileId
     * @return boolean:     
     */
    public static function hasDocProfile($docId, $profileId, $conn = false)
    {
     $q = Doctrine::getTable('arLavernaDocFavorite')
             ->getQueryDocProfile($docId, $profileId, $conn)
             ->select('COUNT(u.id)');

     return ($q->execute(array(),  Doctrine_Core::HYDRATE_SINGLE_SCALAR) > 0);
    }
    
}